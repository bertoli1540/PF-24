library(ggplot2)
library(dplyr)
library(stringr)
library(forcats)
# Exemplo de dados
# Certifique-se de que `melhores` contém as colunas `Nome`, `Medalha` e `freq`
melhores <- top3 %>%
mutate(Nome = case_when(
str_detect(Nome, "auto") ~ "auto",
str_detect(Nome, "manual") ~ "manual",
TRUE ~ Nome  # Preserva os nomes que não contêm "auto" ou "manual"
)) %>%
group_by(Nome, Medalha) %>%
summarise(freq = n(), .groups = "drop") %>%
mutate(freq_relativa = round(freq / sum(freq) * 100, 1))
# Gera as legendas com frequência absoluta e relativa
porcentagens <- str_c(melhores$freq_relativa, "%") %>% str_replace("\\.", ",")
legendas <- str_squish(str_c(melhores$freq, " (", porcentagens, ")"))
# Criação do gráfico com facet_wrap para separar por Nome (atleta)
ggplot(melhores, aes(
x = fct_reorder(Nome, freq, .desc = TRUE),
y = freq,
fill = Medalha,
label = legendas
)) +
geom_col(position = position_dodge2(preserve = "single", padding = 0)) +
geom_text(
position = position_dodge(width = 0.9),
vjust = -0.5,
hjust = 0.5,
size = 3
) +
labs(x = "Nome do Atleta", y = "Frequência") +
theme_estat() +
facet_wrap(~ Nome)  # Cria um painel para cada atleta
library(dplyr)
library(ggplot2)
library(forcats)
library(stringr)
# Adaptando o código para o novo banco de dados e variáveis
trans_drv <- Top3alltimeOlympic %>%
mutate(Nome = case_when(
str_detect(Nome, "auto") ~ "auto",
str_detect(Nome, "manual") ~ "manual",
TRUE ~ Nome  # Mantém o nome original se não for "auto" ou "manual"
)) %>%
group_by(Nome, Medalha) %>%
summarise(freq = n(), .groups = "drop") %>%
mutate(
freq_relativa = round(freq / sum(freq) * 100, 1)
)
library(dplyr)
library(ggplot2)
library(forcats)
library(stringr)
# Adaptando o código para o novo banco de dados e variáveis
trans_drv <- top3 %>%
mutate(Nome = case_when(
str_detect(Nome, "auto") ~ "auto",
str_detect(Nome, "manual") ~ "manual",
TRUE ~ Nome  # Mantém o nome original se não for "auto" ou "manual"
)) %>%
group_by(Nome, Medalha) %>%
summarise(freq = n(), .groups = "drop") %>%
mutate(
freq_relativa = round(freq / sum(freq) * 100, 1)
)
# Calcula as legendas com frequência e porcentagem
porcentagens <- str_c(trans_drv$freq_relativa, "%") %>% str_replace("\\.", ",")
legendas <- str_squish(str_c(trans_drv$freq, " (", porcentagens, ")"))
# Criação do gráfico
ggplot(trans_drv) +
aes(
x = fct_reorder(Nome, freq, .desc = TRUE),
y = freq,
fill = Medalha,
label = legendas
) +
geom_col(position = position_dodge2(preserve = "single", padding = 0)) +
geom_text(
position = position_dodge(width = 0.9),
vjust = -0.5, hjust = 0.5,
size = 3
) +
labs(x = "Nome do Atleta", y = "Quantidade de Medalhas") +
theme_minimal() +  # Ou use `theme_estat()` se for um tema personalizado
ggtitle("Quantidade de Medalhas por Atleta e Tipo de Medalha")
# Salvando o gráfico em PDF
ggsave("colunas-bi-freq.pdf", width = 158, height = 93, units = "mm")
library(dplyr)
library(ggplot2)
library(forcats)
library(stringr)
# Adaptando o código para o novo banco de dados e variáveis
trans_drv <- top3 %>%
mutate(Nome = case_when(
str_detect(Nome, "auto") ~ "auto",
str_detect(Nome, "manual") ~ "manual",
TRUE ~ Nome  # Mantém o nome original se não for "auto" ou "manual"
)) %>%
group_by(Nome, Medalha) %>%
summarise(freq = n(), .groups = "drop") %>%
mutate(
freq_relativa = round(freq / sum(freq) * 100, 1)
)
# Calcula as legendas com frequência e porcentagem
porcentagens <- str_c(trans_drv$freq_relativa, "%") %>% str_replace("\\.", ",")
legendas <- str_squish(str_c(trans_drv$freq, " (", porcentagens, ")"))
# Criação do gráfico
ggplot(trans_drv) +
aes(
x = fct_reorder(Nome, freq, .desc = TRUE),
y = freq,
fill = Medalha,
label = legendas
) +
geom_col(position = position_dodge2(preserve = "single", padding = 0)) +
geom_text(
position = position_dodge(width = 0.9),
vjust = -0.5, hjust = 0.5,
size = 3
) +
labs(x = "Nome do Atleta", y = "Quantidade de Medalhas") +
theme_estat() +  # Ou use `theme_estat()` se for um tema personalizado
ggtitle("Quantidade de Medalhas por Atleta e Tipo de Medalha")
# Salvando o gráfico em PDF
ggsave("colunas-bi-freq.pdf", width = 158, height = 93, units = "mm")
olimpiadas$Peso <- as.numeric(olimpiadas$Peso)
olimpiadas$pesokg = olimpiadas$Peso * 0.453592
olimpiadas$alturam = olimpiadas$Altura / 100
olimpiadas$imc <- olimpiadas$pesokg / (olimpiadas$alturam^2)
judo =  subset(olimpiadas, Esporte == "Judo")
badminton =  subset(olimpiadas, Esporte == "Badminton")
futebol = subset(olimpiadas, Esporte == "Football")
ginastica = subset(olimpiadas, Esporte == "Gymnastics")
atletismo = subset(olimpiadas, Esporte == "Athletics")
espotes=rbind(judo,badminton,futebol,ginastica,atletismo)
espotes$Esporte[espotes$Esporte == "Football"] = "Futebol"
espotes$Esporte[espotes$Esporte == "Gymnastics"] = "Ginastica"
espotes$Esporte[espotes$Esporte == "Athletics"] = "Atletismo"
ggplot(espotes) +
aes(x = reorder(Esporte, imc, FUN = median), y = imc) +
geom_boxplot(aes(fill = "Mediana"), width = 0.5) +
stat_summary(
aes(shape = "Média"), fun = "mean", geom = "point", size = 3, fill = "white"
) +
labs(x = "Esporte", y = "IMC", title = "IMC POR ESPORTE") +
scale_shape_manual(values = c(23)) +
scale_fill_manual(values = c("Mediana" = "#A11D21")) +
guides(fill = "none", shape = "none") +
theme_estat()
library(dplyr)
library(tidyr)
library(stringr)
library(knitr)
print_quadro_resumo <- function(data, var_name, title = "Medidas resumo da(o) [nome da variável]", label = "quad:quadro_resumo1") {
var_name <- substitute(var_name)
# Calcular medidas de resumo
data <- data %>%
summarize(
`Média` = round(mean(!!sym(var_name)), 2),
`Desvio Padrão` = round(sd(!!sym(var_name)), 2),
`Variância` = round(var(!!sym(var_name)), 2),
`Mínimo` = round(min(!!sym(var_name)), 2),
`1º Quartil` = round(quantile(!!sym(var_name), probs = 0.25), 2),
`Mediana` = round(quantile(!!sym(var_name), probs = 0.5), 2),
`3º Quartil` = round(quantile(!!sym(var_name), probs = 0.75), 2),
`Máximo` = round(max(!!sym(var_name)), 2)
) %>%
t() %>%
as.data.frame() %>%
rownames_to_column()
latex <- str_c("\\begin{quadro}[H]\n",
"\\caption{", title, "}\n",
"\\centering\n",
"\\begin{adjustbox}{max width=\\textwidth}\n",
"\\begin{tabular}{", sep = "")
col_count <- ncol(data)
row_count <- nrow(data)
# Definindo formato da tabela
latex <- str_c(latex, "| l |\n", sep = "")
for (i in seq(2, col_count)) {
numCount <- data[i, -c(1)] %>%
as.numeric() %>%
{floor(log10(.)) + 1} %>%
max()
latex <- str_c(latex, "\t\t\tS[table-format = ", numCount, ".2]\n", sep = "")
}
latex <- str_c(latex, "\t\t\t|}\n\t\\toprule\n\t\t", sep = "")
# Cabeçalho da tabela
if (col_count > 2) {
for (i in seq(1, col_count)) {
if (i == 1)
latex <- str_c(latex, "\\textbf{Estatística}", sep = "")
else
latex <- str_c(latex, " \\textbf{", data[1, i], "}", sep = "")
if (i < col_count)
latex <- str_c(latex, "&", sep = "")
else
latex <- str_c(latex, "\\\\\n", sep = "")
}
} else {
latex <- str_c(latex, "\\textbf{Estatística} & \\textbf{Valor} \\\\\n", sep = "")
}
latex <- str_c(latex, "\t\t\\midrule\n", sep = "")
# Preenchendo a tabela com dados
starting_number <- ifelse(col_count > 2, 2, 1)
for (i in seq(starting_number, row_count)) {
latex <- str_c(latex, "\t\t", str_flatten(t(data[i, ]), collapse = " & "), " \\\\\n")
}
# Finalizando a tabela
latex <- str_c(latex, "\t\\bottomrule\n",
"\t\\end{tabular}\n",
"\t\\label{", label, "}\n",
"\t\\end{adjustbox}\n",
"\\end{quadro}", sep = "")
# Escreve o resultado em um arquivo
writeLines(latex)
}
library(dplyr)
library(tidyr)
library(stringr)
library(knitr)
print_quadro_resumo <- function(data, var_name, title = "Medidas resumo dos esportes", label = "quad:quadro_resumo1") {
var_name <- substitute(var_name)
# Calcular medidas de resumo
data <- data %>%
summarize(
`Média` = round(mean(!!sym(var_name)), 2),
`Desvio Padrão` = round(sd(!!sym(var_name)), 2),
`Variância` = round(var(!!sym(var_name)), 2),
`Mínimo` = round(min(!!sym(var_name)), 2),
`1º Quartil` = round(quantile(!!sym(var_name), probs = 0.25), 2),
`Mediana` = round(quantile(!!sym(var_name), probs = 0.5), 2),
`3º Quartil` = round(quantile(!!sym(var_name), probs = 0.75), 2),
`Máximo` = round(max(!!sym(var_name)), 2)
) %>%
t() %>%
as.data.frame() %>%
rownames_to_column()
latex <- str_c("\\begin{quadro}[H]\n",
"\\caption{", title, "}\n",
"\\centering\n",
"\\begin{adjustbox}{max width=\\textwidth}\n",
"\\begin{tabular}{", sep = "")
col_count <- ncol(data)
row_count <- nrow(data)
# Definindo formato da tabela
latex <- str_c(latex, "| l |\n", sep = "")
for (i in seq(2, col_count)) {
numCount <- data[i, -c(1)] %>%
as.numeric() %>%
{floor(log10(.)) + 1} %>%
max()
latex <- str_c(latex, "\t\t\tS[table-format = ", numCount, ".2]\n", sep = "")
}
latex <- str_c(latex, "\t\t\t|}\n\t\\toprule\n\t\t", sep = "")
# Cabeçalho da tabela
if (col_count > 2) {
for (i in seq(1, col_count)) {
if (i == 1)
latex <- str_c(latex, "\\textbf{Estatística}", sep = "")
else
latex <- str_c(latex, " \\textbf{", data[1, i], "}", sep = "")
if (i < col_count)
latex <- str_c(latex, "&", sep = "")
else
latex <- str_c(latex, "\\\\\n", sep = "")
}
} else {
latex <- str_c(latex, "\\textbf{Estatística} & \\textbf{Valor} \\\\\n", sep = "")
}
latex <- str_c(latex, "\t\t\\midrule\n", sep = "")
# Preenchendo a tabela com dados
starting_number <- ifelse(col_count > 2, 2, 1)
for (i in seq(starting_number, row_count)) {
latex <- str_c(latex, "\t\t", str_flatten(t(data[i, ]), collapse = " & "), " \\\\\n")
}
# Finalizando a tabela
latex <- str_c(latex, "\t\\bottomrule\n",
"\t\\end{tabular}\n",
"\t\\label{", label, "}\n",
"\t\\end{adjustbox}\n",
"\\end{quadro}", sep = "")
# Escreve o resultado em um arquivo
writeLines(latex)
}
print_quadro_resumo <- function(data, var_name, title = "Medidas resumo dos esportes", label = "quad:quadro_resumo1") {
var_name <- substitute(var_name)
# Calcular medidas de resumo
data <- data %>%
summarize(
`Média` = round(mean(!!sym(var_name)), 2),
`Desvio Padrão` = round(sd(!!sym(var_name)), 2),
`Variância` = round(var(!!sym(var_name)), 2),
`Mínimo` = round(min(!!sym(var_name)), 2),
`1º Quartil` = round(quantile(!!sym(var_name), probs = 0.25), 2),
`Mediana` = round(quantile(!!sym(var_name), probs = 0.5), 2),
`3º Quartil` = round(quantile(!!sym(var_name), probs = 0.75), 2),
`Máximo` = round(max(!!sym(var_name)), 2)
) %>%
t() %>%
as.data.frame() %>%
rownames_to_column()
latex <- str_c("\\begin{quadro}[H]\n",
"\\caption{", title, "}\n",
"\\centering\n",
"\\begin{adjustbox}{max width=\\textwidth}\n",
"\\begin{tabular}{", sep = "")
col_count <- ncol(data)
row_count <- nrow(data)
# Definindo formato da tabela
latex <- str_c(latex, "| l |\n", sep = "")
for (i in seq(2, col_count)) {
numCount <- data[i, -c(1)] %>%
as.numeric() %>%
{floor(log10(.)) + 1} %>%
max()
latex <- str_c(latex, "\t\t\tS[table-format = ", numCount, ".2]\n", sep = "")
}
latex <- str_c(latex, "\t\t\t|}\n\t\\toprule\n\t\t", sep = "")
# Cabeçalho da tabela
if (col_count > 2) {
for (i in seq(1, col_count)) {
if (i == 1)
latex <- str_c(latex, "\\textbf{Estatística}", sep = "")
else
latex <- str_c(latex, " \\textbf{", data[1, i], "}", sep = "")
if (i < col_count)
latex <- str_c(latex, "&", sep = "")
else
latex <- str_c(latex, "\\\\\n", sep = "")
}
} else {
latex <- str_c(latex, "\\textbf{Estatística} & \\textbf{Valor} \\\\\n", sep = "")
}
latex <- str_c(latex, "\t\t\\midrule\n", sep = "")
# Preenchendo a tabela com dados
starting_number <- ifelse(col_count > 2, 2, 1)
for (i in seq(starting_number, row_count)) {
latex <- str_c(latex, "\t\t", str_flatten(t(data[i, ]), collapse = " & "), " \\\\\n")
}
# Finalizando a tabela
latex <- str_c(latex, "\t\\bottomrule\n",
"\t\\end{tabular}\n",
"\t\\label{", label, "}\n",
"\t\\end{adjustbox}\n",
"\\end{quadro}", sep = "")
# Escreve o resultado em um arquivo
writeLines(latex)
}
olimpiadas$Peso <- as.numeric(olimpiadas$Peso)
olimpiadas$pesokg = olimpiadas$Peso * 0.453592
olimpiadas$alturam = olimpiadas$Altura / 100
olimpiadas$imc <- olimpiadas$pesokg / (olimpiadas$alturam^2)
judo =  subset(olimpiadas, Esporte == "Judo")
badminton =  subset(olimpiadas, Esporte == "Badminton")
futebol = subset(olimpiadas, Esporte == "Football")
ginastica = subset(olimpiadas, Esporte == "Gymnastics")
atletismo = subset(olimpiadas, Esporte == "Athletics")
espotes=rbind(judo,badminton,futebol,ginastica,atletismo)
espotes$Esporte[espotes$Esporte == "Football"] = "Futebol"
espotes$Esporte[espotes$Esporte == "Gymnastics"] = "Ginastica"
espotes$Esporte[espotes$Esporte == "Athletics"] = "Atletismo"
ggplot(espotes) +
aes(x = reorder(Esporte, imc, FUN = median), y = imc) +
geom_boxplot(aes(fill = "Mediana"), width = 0.5) +
stat_summary(
aes(shape = "Média"), fun = "mean", geom = "point", size = 3, fill = "white"
) +
labs(x = "Esporte", y = "IMC", title = "IMC POR ESPORTE") +
scale_shape_manual(values = c(23)) +
scale_fill_manual(values = c("Mediana" = "#A11D21")) +
guides(fill = "none", shape = "none") +
theme_estat()
ggsave("box_imc_esportes_sem_legenda.pdf", width = 158, height = 93, units = "mm")
View(espotes)
library(dplyr)
library(tidyr)
library(stringr)
library(knitr)
print_quadro_resumo <- function(data, var_name, title = "Medidas resumo dos esportes", label = "quad:quadro_resumo1") {
var_name <- substitute(var_name)
# Calcular medidas de resumo
data <- data %>%
summarize(
`Média` = round(mean(!!sym(var_name)), 2),
`Desvio Padrão` = round(sd(!!sym(var_name)), 2),
`Variância` = round(var(!!sym(var_name)), 2),
`Mínimo` = round(min(!!sym(var_name)), 2),
`1º Quartil` = round(quantile(!!sym(var_name), probs = 0.25), 2),
`Mediana` = round(quantile(!!sym(var_name), probs = 0.5), 2),
`3º Quartil` = round(quantile(!!sym(var_name), probs = 0.75), 2),
`Máximo` = round(max(!!sym(var_name)), 2)
) %>%
t() %>%
as.data.frame() %>%
rownames_to_column()
latex <- str_c("\\begin{quadro}[H]\n",
"\\caption{", title, "}\n",
"\\centering\n",
"\\begin{adjustbox}{max width=\\textwidth}\n",
"\\begin{tabular}{", sep = "")
col_count <- ncol(data)
row_count <- nrow(data)
# Definindo formato da tabela
latex <- str_c(latex, "| l |\n", sep = "")
for (i in seq(2, col_count)) {
numCount <- data[i, -c(1)] %>%
as.numeric() %>%
{floor(log10(.)) + 1} %>%
max()
latex <- str_c(latex, "\t\t\tS[table-format = ", numCount, ".2]\n", sep = "")
}
latex <- str_c(latex, "\t\t\t|}\n\t\\toprule\n\t\t", sep = "")
# Cabeçalho da tabela
if (col_count > 2) {
for (i in seq(1, col_count)) {
if (i == 1)
latex <- str_c(latex, "\\textbf{Estatística}", sep = "")
else
latex <- str_c(latex, " \\textbf{", data[1, i], "}", sep = "")
if (i < col_count)
latex <- str_c(latex, "&", sep = "")
else
latex <- str_c(latex, "\\\\\n", sep = "")
}
} else {
latex <- str_c(latex, "\\textbf{Estatística} & \\textbf{Valor} \\\\\n", sep = "")
}
latex <- str_c(latex, "\t\t\\midrule\n", sep = "")
# Preenchendo a tabela com dados
starting_number <- ifelse(col_count > 2, 2, 1)
for (i in seq(starting_number, row_count)) {
latex <- str_c(latex, "\t\t", str_flatten(t(data[i, ]), collapse = " & "), " \\\\\n")
}
# Finalizando a tabela
latex <- str_c(latex, "\t\\bottomrule\n",
"\t\\end{tabular}\n",
"\t\\label{", label, "}\n",
"\t\\end{adjustbox}\n",
"\\end{quadro}", sep = "")
# Escreve o resultado em um arquivo
writeLines(latex)
}
espotes %>%
group_by(Esporte) %>%
print_quadro_resumo(var_name = imc)
print_quadro_resumo <- function(data, var_name, title = "Medidas resumo da(o) [nome da variável]", label = "quad:quadro_resumo1") {
var_name <- substitute(var_name)
# Calcular medidas de resumo, ignorando valores NA
data <- data %>%
summarize(
`Média` = round(mean(!!sym(var_name), na.rm = TRUE), 2),
`Desvio Padrão` = round(sd(!!sym(var_name), na.rm = TRUE), 2),
`Variância` = round(var(!!sym(var_name), na.rm = TRUE), 2),
`Mínimo` = round(min(!!sym(var_name), na.rm = TRUE), 2),
`1º Quartil` = round(quantile(!!sym(var_name), probs = 0.25, na.rm = TRUE), 2),
`Mediana` = round(quantile(!!sym(var_name), probs = 0.5, na.rm = TRUE), 2),
`3º Quartil` = round(quantile(!!sym(var_name), probs = 0.75, na.rm = TRUE), 2),
`Máximo` = round(max(!!sym(var_name), na.rm = TRUE), 2)
) %>%
t() %>%
as.data.frame() %>%
rownames_to_column()
latex <- str_c("\\begin{quadro}[H]\n",
"\\caption{", title, "}\n",
"\\centering\n",
"\\begin{adjustbox}{max width=\\textwidth}\n",
"\\begin{tabular}{", sep = "")
col_count <- ncol(data)
row_count <- nrow(data)
latex <- str_c(latex, "| l |\n", sep = "")
for (i in seq(2, col_count)) {
numCount <- data[i, -c(1)] %>%
as.numeric() %>%
{floor(log10(.)) + 1} %>%
max()
latex <- str_c(latex, "\t\t\tS[table-format = ", numCount, ".2]\n", sep = "")
}
latex <- str_c(latex, "\t\t\t|}\n\t\\toprule\n\t\t", sep = "")
if (col_count > 2) {
for (i in seq(1, col_count)) {
if (i == 1)
latex <- str_c(latex, "\\textbf{Estatística}", sep = "")
else
latex <- str_c(latex, " \\textbf{", data[1, i], "}", sep = "")
if (i < col_count)
latex <- str_c(latex, "&", sep = "")
else
latex <- str_c(latex, "\\\\\n", sep = "")
}
} else {
latex <- str_c(latex, "\\textbf{Estatística} & \\textbf{Valor} \\\\\n", sep = "")
}
latex <- str_c(latex, "\t\t\\midrule\n", sep = "")
starting_number <- ifelse(col_count > 2, 2, 1)
for (i in seq(starting_number, row_count)) {
latex <- str_c(latex, "\t\t", str_flatten(t(data[i, ]), collapse = " & "), " \\\\\n")
}
latex <- str_c(latex, "\t\\bottomrule\n",
"\t\\end{tabular}\n",
"\t\\label{", label, "}\n",
"\t\\end{adjustbox}\n",
"\\end{quadro}", sep = "")
writeLines(latex)
}
espotes %>%
group_by(Esporte) %>%
print_quadro_resumo(var_name = imc)
\begin{quadro}[H]
\documentclass{article}
